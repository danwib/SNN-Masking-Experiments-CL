name: stage5A1_sequential_X_Xprime_soft_sleep_dynamic_lowtemp
experiment_type: sequential
tasks:
  - name: task1
    task_id: 0
    prompt: task1
    column_index: 0
    dataset_variant: task1
  - name: task2
    task_id: 1
    prompt: task2
    column_index: 1
    dataset_variant: task2
  - name: task1_prime
    task_id: 2
    prompt: task1_prime
    column_index: 2
    dataset_variant: task1_prime
    consolidate_into: task1
  - name: task2_prime
    task_id: 3
    prompt: task2_prime
    column_index: 3
    dataset_variant: task2_prime
    consolidate_into: task2
dataset:
  root: assets/data
  held_out_fraction: 0.2
  max_train_samples: 4000
  use_fake_data: false
  download: true
training:
  epochs: 20
  batch_size: 64
  base_learning_rate: 0.02
  seed: 101
  task_schedule:
    - task1
    - task2
    - task1_prime
    - task2_prime
masking:
  learning_rate_scale: 0.35
  threshold_shift: 0.2
  prompt_vector_dim: 16
  prompt_mode: learned_task_id
  prompt_learning_rate: 0.02
  include_input_in_prompt: true
  prompt_input_scale: 0.7
  mode: soft_columns
  soft_columns:
    total_columns: 8
    base_columns: 4
    base_tasks:
      - task1
      - task2
    novel_tasks:
      - task1_prime
      - task2_prime
    temperature: 0.3
    lambda_entropy: 0.02
    lambda_balance: 0.03
    lambda_overlap_novel: 0.02
    mask_learning_rate: 0.05
model:
  hidden_per_column: 32
  time_steps: 5
  beta: 0.9
sleep:
  enabled: true
  epochs: 10
  batch_size: 64
  label_weight: 0.0
  distillation_weight: 1.0
  temperature: 0.0
  held_out_replay: 0
  dynamic:
    enabled: true
    warmup_passes: 0.75
    prime_warmup_passes: 0.5
    top_percent: 0.4
    extra_percent: 0.2
    min_probability: 0.1
    use_moving_average: true
    momentum: 0.85
    initial_loss: 1.0
